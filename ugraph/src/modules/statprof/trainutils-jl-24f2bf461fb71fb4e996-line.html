<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="statprofiler.css">

    <title>StatProfilerHTML.jl: /home/arashyazdiha/Dropbox/Arash/EUR/Workspace/CLSM/Julia Implementation/ProjectLN/ugraph/src/modules/./trainutils.jl</title>
  </head>
  <body>
<div class="report-header">
  <div class="backlink"><a href="index.html">Report index</a></div>
  <div class="report-title">StatProfilerHTML.jl report</div>
  <div class="generated-on">Generated on wo 04 apr 2018 12:37:42 CEST</div>
</div>

    <div id="body-content">
      <table>
        <caption>File source code</caption>
        <tr>
          <th>Line</td>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-1"></a>1</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">__precompile__()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-2"></a>2</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">module TrainUtils
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-3"></a>3</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-4"></a>4</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">export updatephil!,updatephinl!,updatephinlout!,updatephinlin!,sfx,dfunci,updateμ!,updateM!,updatem!,updatel!
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-5"></a>5</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">export updateL!,updateb0!,updateb1!,estimate_βs!,estimate_θs!,estimate_θs!,estimate_μs,update_Elogβ!
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-6"></a>6</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">import Model: LNMMSB
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-7"></a>7</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">import Utils: MiniBatch, Link, NonLink, logsumexp, softmax,digamma_, EPSILON
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-8"></a>8</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">using GradDescent
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-9"></a>9</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">using ForwardDiff
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-10"></a>10</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-11"></a>11</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-12"></a>12</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephil-12"></a>
              3053 (6.87%) samples spent in updatephil!<br />
              73 (100.00%) (ex.),
              3053 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-99">line 99</a><br />
            </div>
            <span class="code">function updatephil!(model::LNMMSB, mb::MiniBatch, link::Link, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-13"></a>13</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	a = link.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-14"></a>14</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	b = link.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-15"></a>15</td>
          <td>4 (0.0090%)</td>
          <td>38 (0.09%)</td>
          <td>
            <div class="callees">
              34 (89.47%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_a = vcat(model.A[a], model.C[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-16"></a>16</td>
          <td>4 (0.0090%)</td>
          <td>62 (0.14%)</td>
          <td>
            <div class="callees">
              58 (93.55%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_b = vcat(model.A[b], model.C[b])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-17"></a>17</td>
          <td>9 (0.02%)</td>
          <td>9 (0.02%)</td>
          <td>
            <span class="code">	vala = !isempty(model.B[a])? model.μ_var[a, model.B[a][1]]: 0.0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-18"></a>18</td>
          <td>7 (0.02%)</td>
          <td>7 (0.02%)</td>
          <td>
            <span class="code">	valb = !isempty(model.B[b])? model.μ_var[b, model.B[b][1]]: 0.0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-19"></a>19</td>
          <td>1 (0.0023%)</td>
          <td>490 (1.10%)</td>
          <td>
            <div class="callees">
              11 (2.24%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              122 (24.90%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              356 (72.65%)
              samples spent calling
              <a href="operators-jl-e82ac3fc71309b1fcf2d-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-operators-jl-424">+</a><br />
            </div>
            <span class="code">	link.ϕ[:] = model.Elogβ0[:] + vala + valb
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-20"></a>20</td>
          <td>2 (0.0045%)</td>
          <td>2 (0.0045%)</td>
          <td>
            <span class="code">	for k in union_a
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-21"></a>21</td>
          <td>14 (0.03%)</td>
          <td>14 (0.03%)</td>
          <td>
            <span class="code">		link.ϕ[k] += model.μ_var[a,k] - vala
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-22"></a>22</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-23"></a>23</td>
          <td>3 (0.0068%)</td>
          <td>3 (0.0068%)</td>
          <td>
            <span class="code">	for k in union_b
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-24"></a>24</td>
          <td>19 (0.04%)</td>
          <td>19 (0.04%)</td>
          <td>
            <span class="code">		link.ϕ[k] += model.μ_var[b,k] - valb
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-25"></a>25</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-26"></a>26</td>
          <td>1 (0.0023%)</td>
          <td>965 (2.17%)</td>
          <td>
            <div class="callees">
              16 (1.66%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              948 (98.24%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-logsumexp-116">logsumexp</a><br />
            </div>
            <span class="code">	r = logsumexp(link.ϕ)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-27"></a>27</td>
          <td>3 (0.0068%)</td>
          <td>1438 (3.24%)</td>
          <td>
            <div class="callees">
              1124 (78.16%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              299 (20.79%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              12 (0.83%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
            </div>
            <span class="code">	link.ϕ[:] = exp.(link.ϕ[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-28"></a>28</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-29"></a>29</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatephinl!(model::LNMMSB, mb::MiniBatch, nlink::NonLink)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-30"></a>30</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-31"></a>31</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-32"></a>32</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		nlink.ϕout[k] = model.μ_var[nlink.src,k] + nlink.ϕin[k]*(model.Elogβ1[k]-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-33"></a>33</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		nlink.ϕin[k] = model.μ_var[nlink.dst,k] + nlink.ϕout[k]*(model.Elogβ1[k]-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-34"></a>34</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-35"></a>35</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	r = logsumexp(nlink.ϕout)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-36"></a>36</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nlink.ϕout[:] = exp.(nlink.ϕout[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-37"></a>37</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	r=logsumexp(nlink.ϕin)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-38"></a>38</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nlink.ϕin[:] = exp.(nlink.ϕin[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-39"></a>39</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-40"></a>40</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#I think this requires the two updates to be separated
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-41"></a>41</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinl-41"></a>
              30624 (68.94%) samples spent in updatephinl!<br />
              202 (100.00%) (ex.),
              30624 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-111">line 111</a><br />
            </div>
            <span class="code">function updatephinl!(model::LNMMSB, mb::MiniBatch, nlink::NonLink, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-42"></a>42</td>
          <td>162 (0.36%)</td>
          <td>192 (0.43%)</td>
          <td>
            <div class="callees">
              30 (15.62%)
              samples spent calling
              <a href="random-jl-3c29f269282a0112ca95-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-random-jl-rand-396">rand!</a><br />
            </div>
            <span class="code">	if rand(Bool, 1)[1]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-43"></a>43</td>
          <td>9 (0.02%)</td>
          <td>7610 (17.13%)</td>
          <td>
            <div class="callees">
              1 (0.01%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-logsumexp-116">logsumexp</a><br />
              7564 (99.40%)
              samples spent calling
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinlout-53">updatephinlout!</a><br />
              35 (0.46%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              1 (0.01%)
              samples spent calling
              <a href="mvnormalcanon-jl-f636218910b12a20b6cf-line.html#S-home-arashyazdiha-julia-v0-6-Distributions-src-multivariate-mvnormalcanon-jl-Type-109">Type</a><br />
            </div>
            <span class="code">		updatephinlout!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-44"></a>44</td>
          <td>8 (0.02%)</td>
          <td>7428 (16.72%)</td>
          <td>
            <div class="callees">
              38 (0.51%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              7382 (99.38%)
              samples spent calling
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinlin-66">updatephinlin!</a><br />
            </div>
            <span class="code">		updatephinlin!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-45"></a>45</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	else
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-46"></a>46</td>
          <td>3 (0.0068%)</td>
          <td>7626 (17.17%)</td>
          <td>
            <div class="callees">
              1 (0.01%)
              samples spent calling
              <a href="multidimensional-jl-b15f86aca7aa36da9d41-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-multidimensional-jl-_unsafe_getindex-505">_unsafe_getindex</a><br />
              35 (0.46%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              7587 (99.49%)
              samples spent calling
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinlin-66">updatephinlin!</a><br />
            </div>
            <span class="code">		updatephinlin!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-47"></a>47</td>
          <td>12 (0.03%)</td>
          <td>7760 (17.47%)</td>
          <td>
            <div class="callees">
              4 (0.05%)
              samples spent calling
              <a href="mvnormalcanon-jl-f636218910b12a20b6cf-line.html#S-home-arashyazdiha-julia-v0-6-Distributions-src-multivariate-mvnormalcanon-jl-Type-109">Type</a><br />
              1 (0.01%)
              samples spent calling
              <a href="multidimensional-jl-b15f86aca7aa36da9d41-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-multidimensional-jl-updatephinlout-53">updatephinlout!</a><br />
              45 (0.58%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              7698 (99.20%)
              samples spent calling
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinlout-53">updatephinlout!</a><br />
            </div>
            <span class="code">		updatephinlout!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-48"></a>48</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-49"></a>49</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-50"></a>50</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-51"></a>51</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-52"></a>52</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">##
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-53"></a>53</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinlout-53"></a>
              15262 (34.36%) samples spent in updatephinlout!<br />
              75 (53.57%) (ex.),
              7564 (49.56%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-43">line 43</a><br />
              65 (46.43%) (ex.),
              7698 (50.44%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-47">line 47</a><br />
            </div>
            <span class="code">function updatephinlout!(model::LNMMSB, mb::MiniBatch, nlink::NonLink, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-54"></a>54</td>
          <td>4 (0.0090%)</td>
          <td>4 (0.0090%)</td>
          <td>
            <span class="code">	a = nlink.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-55"></a>55</td>
          <td>1 (0.0023%)</td>
          <td>1 (0.0023%)</td>
          <td>
            <span class="code">	b = nlink.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-56"></a>56</td>
          <td>2 (0.0045%)</td>
          <td>811 (1.83%)</td>
          <td>
            <div class="callees">
              751 (92.60%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              58 (7.15%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-log1p-419">log1p</a><br />
            </div>
            <span class="code">	constant = (model.Elogβ1 .-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-57"></a>57</td>
          <td>4 (0.0090%)</td>
          <td>1110 (2.50%)</td>
          <td>
            <div class="callees">
              1052 (94.77%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              48 (4.32%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              2 (0.18%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-627">setindex!</a><br />
              4 (0.36%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-626">setindex!</a><br />
            </div>
            <span class="code">	nlink.ϕout[:] = model.μ_var[a,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-58"></a>58</td>
          <td>41 (0.09%)</td>
          <td>317 (0.71%)</td>
          <td>
            <div class="callees">
              276 (87.07%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_b = vcat(model.A[b], model.C[b])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-59"></a>59</td>
          <td>7 (0.02%)</td>
          <td>7 (0.02%)</td>
          <td>
            <span class="code">	for k in union_b
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-60"></a>60</td>
          <td>58 (0.13%)</td>
          <td>58 (0.13%)</td>
          <td>
            <span class="code">		nlink.ϕout[k] += nlink.ϕin[k]*constant[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-61"></a>61</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-62"></a>62</td>
          <td>5 (0.01%)</td>
          <td>5141 (11.57%)</td>
          <td>
            <div class="callees">
              2 (0.04%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-logsumexp-116">logsumexp</a><br />
              5049 (98.21%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-logsumexp-116">logsumexp</a><br />
              85 (1.65%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
            </div>
            <span class="code">	r = logsumexp(nlink.ϕout)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-63"></a>63</td>
          <td>5 (0.01%)</td>
          <td>7800 (17.56%)</td>
          <td>
            <div class="callees">
              2 (0.03%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-627">setindex!</a><br />
              1771 (22.71%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              61 (0.78%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              6 (0.08%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-626">setindex!</a><br />
              5953 (76.32%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              2 (0.03%)
              samples spent calling
              <a href="mvnormalcanon-jl-f636218910b12a20b6cf-line.html#S-home-arashyazdiha-julia-v0-6-Distributions-src-multivariate-mvnormalcanon-jl-Type-109">Type</a><br />
            </div>
            <span class="code">	nlink.ϕout[:] = exp.(nlink.ϕout[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-64"></a>64</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-65"></a>65</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-66"></a>66</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatephinlin-66"></a>
              14970 (33.70%) samples spent in updatephinlin!<br />
              1 (0.55%) (ex.),
              1 (0.0067%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-111">line 111</a><br />
              84 (45.90%) (ex.),
              7382 (49.31%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-44">line 44</a><br />
              98 (53.55%) (ex.),
              7587 (50.68%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-46">line 46</a><br />
            </div>
            <span class="code">function updatephinlin!(model::LNMMSB, mb::MiniBatch, nlink::NonLink, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-67"></a>67</td>
          <td>1 (0.0023%)</td>
          <td>1 (0.0023%)</td>
          <td>
            <span class="code">	a = nlink.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-68"></a>68</td>
          <td>2 (0.0045%)</td>
          <td>2 (0.0045%)</td>
          <td>
            <span class="code">	b = nlink.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-69"></a>69</td>
          <td>2 (0.0045%)</td>
          <td>778 (1.75%)</td>
          <td>
            <div class="callees">
              707 (90.87%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              69 (8.87%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-log1p-419">log1p</a><br />
            </div>
            <span class="code">	constant = (model.Elogβ1 .-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-70"></a>70</td>
          <td>6 (0.01%)</td>
          <td>1179 (2.65%)</td>
          <td>
            <div class="callees">
              2 (0.17%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-627">setindex!</a><br />
              40 (3.39%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              1130 (95.84%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              1 (0.08%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-626">setindex!</a><br />
            </div>
            <span class="code">	nlink.ϕin[:] = model.μ_var[b,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-71"></a>71</td>
          <td>66 (0.15%)</td>
          <td>365 (0.82%)</td>
          <td>
            <div class="callees">
              299 (81.92%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_a = vcat(model.A[a], model.C[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-72"></a>72</td>
          <td>13 (0.03%)</td>
          <td>13 (0.03%)</td>
          <td>
            <span class="code">	for k in union_a
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-73"></a>73</td>
          <td>64 (0.14%)</td>
          <td>64 (0.14%)</td>
          <td>
            <span class="code">		nlink.ϕin[k] += nlink.ϕout[k]*constant[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-74"></a>74</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-75"></a>75</td>
          <td>3 (0.0068%)</td>
          <td>5055 (11.38%)</td>
          <td>
            <div class="callees">
              1 (0.02%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-logsumexp-116">logsumexp</a><br />
              70 (1.38%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              4981 (98.54%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-logsumexp-116">logsumexp</a><br />
            </div>
            <span class="code">	r=logsumexp(nlink.ϕin)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-76"></a>76</td>
          <td>11 (0.02%)</td>
          <td>7498 (16.88%)</td>
          <td>
            <div class="callees">
              5766 (76.90%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              2 (0.03%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-626">setindex!</a><br />
              1651 (22.02%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              2 (0.03%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-627">setindex!</a><br />
              66 (0.88%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
            </div>
            <span class="code">	nlink.ϕin[:] = exp.(nlink.ϕin[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-77"></a>77</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-78"></a>78</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">##
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-79"></a>79</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-80"></a>80</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function sfx(μ_var::Vector{Float64},ltemp::Vector{Float64})
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-81"></a>81</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	return softmax(μ_var .+.5.*exp.(ltemp))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-82"></a>82</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-83"></a>83</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function sfx(μ_var::Vector{Float64})
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-84"></a>84</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	return softmax(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-85"></a>85</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-86"></a>86</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-87"></a>87</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function my_adagrad(f_grad, x0, data, args, stepsize=1e-2, fudge_factor=1e-6, max_it=1000, minibatchsize=nothing, minibatch_ratio=0.01)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-88"></a>88</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-89"></a>89</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-90"></a>90</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-91"></a>91</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-92"></a>92</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-93"></a>93</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-dfunci-93"></a>
              1973 (4.44%) samples spent in dfunci<br />
              0 (ex.),
              1973 (100.00%) (incl.)
              when called from
              updateμ!
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-113">line 113</a><br />
            </div>
            <span class="code">function dfunci(μ_var::Vector{Float64}, model::LNMMSB, X::Vector{Float64}, x::Vector{Float64}, sumb::Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-94"></a>94</td>
          <td></td>
          <td>1973 (4.44%)</td>
          <td>
            <div class="callees">
              4 (0.20%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              655 (33.20%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              1298 (65.79%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-gemv-252">gemv!</a><br />
              5 (0.25%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-75">*</a><br />
              11 (0.56%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">-</a><br />
            </div>
            <span class="code">	-model.l.*model.L*(μ_var-model.m) +X - sumb.*x
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-95"></a>95</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-96"></a>96</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function updateμ!(model::LNMMSB, a::Int64,mb::MiniBatch, check::String, N::Int64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-97"></a>97</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-update-97"></a>
              2139 (4.82%) samples spent in updateμ!<br />
              2 (100.00%) (ex.),
              2139 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-127">line 127</a><br />
            </div>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-98"></a>98</td>
          <td></td>
          <td>5 (0.01%)</td>
          <td>
            <div class="callees">
              1 (20.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
              4 (80.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-setindex-968">setindex!</a><br />
            </div>
            <span class="code">	model.μ_var_old[a,:]=deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-99"></a>99</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-100"></a>100</td>
          <td></td>
          <td>4 (0.0090%)</td>
          <td>
            <div class="callees">
              4 (100.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	μ_var = deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-101"></a>101</td>
          <td></td>
          <td>13 (0.03%)</td>
          <td>
            <div class="callees">
              12 (92.31%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-softmax-152">softmax</a><br />
              1 (7.69%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
            </div>
            <span class="code">	x = sfx(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-102"></a>102</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s1 = haskey(mb.mbnot,a)?convert(Float64,(N-1-model.train_deg[a])):0.0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-103"></a>103</td>
          <td></td>
          <td>2 (0.0045%)</td>
          <td>
            <div class="callees">
              2 (100.00%)
              samples spent calling
              <a href="dict-jl-69dc10398ca233bdae58-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-dict-jl-getindex-474">getindex</a><br />
            </div>
            <span class="code">	c1 = haskey(mb.mbnot,a)?convert(Float64, length(mb.mbnot[a])):1.0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-104"></a>104</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-105"></a>105</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	sumb =(convert(Float64,model.N)*-1.0)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-106"></a>106</td>
          <td></td>
          <td>5 (0.01%)</td>
          <td>
            <div class="callees">
              1 (20.00%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              4 (80.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">	X=model.ϕlsum[a,:]+(s1/c1).*.5.*(model.ϕnloutsum[a,:]+model.ϕnlinsum[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-107"></a>107</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-108"></a>108</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-109"></a>109</td>
          <td></td>
          <td>1 (0.0023%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="AdaGradOptimizer-jl-7c6670f2b61e6bc30b2d-line.html#S-home-arashyazdiha-julia-v0-6-GradDescent-src-AdaGradOptimizer-jl-Adagrad-2-10">#Adagrad#2</a><br />
            </div>
            <span class="code">	opt1 = Adagrad()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-110"></a>110</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-111"></a>111</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for i in 1:10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-112"></a>112</td>
          <td></td>
          <td>77 (0.17%)</td>
          <td>
            <div class="callees">
              77 (100.00%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-softmax-152">softmax</a><br />
            </div>
            <span class="code">		x  = sfx(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-113"></a>113</td>
          <td>1 (0.0023%)</td>
          <td>1974 (4.44%)</td>
          <td>
            <div class="callees">
              1973 (99.95%)
              samples spent calling
              <a href="trainutils-jl-24f2bf461fb71fb4e996-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-dfunci-93">dfunci</a><br />
            </div>
            <span class="code">		g1 = dfunci(μ_var, model, X, x, sumb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-114"></a>114</td>
          <td></td>
          <td>53 (0.12%)</td>
          <td>
            <div class="callees">
              53 (100.00%)
              samples spent calling
              <a href="AdaGradOptimizer-jl-7c6670f2b61e6bc30b2d-line.html#S-home-arashyazdiha-julia-v0-6-GradDescent-src-AdaGradOptimizer-jl-update-20">update</a><br />
            </div>
            <span class="code">		δ1 = update(opt1,g1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-115"></a>115</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		# @code_warntype update(opt1,g1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-116"></a>116</td>
          <td></td>
          <td>4 (0.0090%)</td>
          <td>
            <div class="callees">
              4 (100.00%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
            </div>
            <span class="code">		μ_var+=δ1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-117"></a>117</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-118"></a>118</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.μ_var[a,:]=μ_var
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-119"></a>119</td>
          <td>1 (0.0023%)</td>
          <td>1 (0.0023%)</td>
          <td>
            <span class="code">	print();
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-120"></a>120</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-121"></a>121</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-122"></a>122</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updateM-122"></a>
              44 (0.10%) samples spent in updateM!<br />
              0 (ex.),
              44 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-136">line 136</a><br />
            </div>
            <span class="code">function updateM!(model::LNMMSB,mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-123"></a>123</td>
          <td></td>
          <td>15 (0.03%)</td>
          <td>
            <div class="callees">
              15 (100.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	model.M_old = deepcopy(model.M)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-124"></a>124</td>
          <td></td>
          <td>29 (0.07%)</td>
          <td>
            <div class="callees">
              12 (41.38%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              17 (58.62%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
            </div>
            <span class="code">	model.M = ((model.l*model.N).*model.L)+model.M0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-125"></a>125</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-126"></a>126</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#updateM!(model,mb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-127"></a>127</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updatem-127"></a>
              527 (1.19%) samples spent in updatem!<br />
              0 (ex.),
              527 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-134">line 134</a><br />
            </div>
            <span class="code">function updatem!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-128"></a>128</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.m_old = deepcopy(model.m)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-129"></a>129</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s = zeros(Float64, model.K)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-130"></a>130</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-131"></a>131</td>
          <td></td>
          <td>2 (0.0045%)</td>
          <td>
            <div class="callees">
              1 (50.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              1 (50.00%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-206">broadcast!</a><br />
            </div>
            <span class="code">		s.+=model.μ_var[a,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-132"></a>132</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-133"></a>133</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-134"></a>134</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	scaler = model.N/model.mbsize
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-135"></a>135</td>
          <td></td>
          <td>525 (1.18%)</td>
          <td>
            <div class="callees">
              21 (4.00%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              32 (6.10%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-gemv-252">gemv!</a><br />
              472 (89.90%)
              samples spent calling
              <a href="dense-jl-9a4e14799b411a7dd560-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-dense-jl-inv-650">inv</a><br />
            </div>
            <span class="code">	model.m=inv(model.M)*(model.M0*model.m0+(scaler*model.l).*model.L*s)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-136"></a>136</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-137"></a>137</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function updatel!(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-138"></a>138</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	##should be set in advance, not needed in the loop
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-139"></a>139</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.l = model.l0+convert(Float64,model.N)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-140"></a>140</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-141"></a>141</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#updatel!(model,mb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-142"></a>142</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updateL-142"></a>
              1209 (2.72%) samples spent in updateL!<br />
              0 (ex.),
              1209 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-138">line 138</a><br />
            </div>
            <span class="code">function updateL!(model::LNMMSB, mb::MiniBatch, i::Int64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-143"></a>143</td>
          <td></td>
          <td>15 (0.03%)</td>
          <td>
            <div class="callees">
              15 (100.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	model.L_old = deepcopy(model.L)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-144"></a>144</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s = zero(Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-145"></a>145</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-146"></a>146</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# 	s +=(model.μ_var[a,:]-model.m)*(model.μ_var[a,:]-model.m)&#39;+diagm(1.0./model.Λ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-147"></a>147</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-148"></a>148</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	#added this for instead
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-149"></a>149</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-150"></a>150</td>
          <td></td>
          <td>204 (0.46%)</td>
          <td>
            <div class="callees">
              91 (44.61%)
              samples spent calling
              <a href="rowvector-jl-71775e009ff557a81d0d-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-rowvector-jl-A_mul_Bc-216">A_mul_Bc</a><br />
              2 (0.98%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              15 (7.35%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-44">+</a><br />
              93 (45.59%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              3 (1.47%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">-</a><br />
            </div>
            <span class="code">		s +=(model.μ_var[a,:]-model.m)*(model.μ_var[a,:]-model.m)&#39;
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-151"></a>151</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-152"></a>152</td>
          <td></td>
          <td>27 (0.06%)</td>
          <td>
            <div class="callees">
              27 (100.00%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-44">*</a><br />
            </div>
            <span class="code">	s=(model.N/model.mbsize)*s
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-153"></a>153</td>
          <td></td>
          <td>598 (1.35%)</td>
          <td>
            <div class="callees">
              47 (7.86%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              23 (3.85%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              528 (88.29%)
              samples spent calling
              <a href="dense-jl-9a4e14799b411a7dd560-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-dense-jl-inv-650">inv</a><br />
            </div>
            <span class="code">	s+=inv(model.L0)+model.N.*inv(model.M)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-154"></a>154</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.L = try
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-155"></a>155</td>
          <td></td>
          <td>365 (0.82%)</td>
          <td>
            <div class="callees">
              365 (100.00%)
              samples spent calling
              <a href="dense-jl-9a4e14799b411a7dd560-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-dense-jl-inv-650">inv</a><br />
            </div>
            <span class="code">		inv(s)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-156"></a>156</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	catch y
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-157"></a>157</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		if isa(y, Base.LinAlg.SingularException)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-158"></a>158</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">			println(&quot;i is &quot;, i)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-159"></a>159</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">			error(&quot;hey hey hey singular&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-160"></a>160</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-161"></a>161</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-162"></a>162</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-163"></a>163</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-164"></a>164</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-165"></a>165</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-166"></a>166</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updateb0-166"></a>
              4 (0.0090%) samples spent in updateb0!<br />
              1 (100.00%) (ex.),
              4 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-140">line 140</a><br />
            </div>
            <span class="code">function updateb0!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-167"></a>167</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.b0_old = deepcopy(model.b0)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-168"></a>168</td>
          <td>1 (0.0023%)</td>
          <td>1 (0.0023%)</td>
          <td>
            <span class="code">	scaler=nnz(model.network)/(2*length(mb.mblinks))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-169"></a>169</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# @assert !isequal(model.ϕlinoutsum[:], zeros(Float64, model.K))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-170"></a>170</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s = zeros(Float64, model.K)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-171"></a>171</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in model.mbids
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-172"></a>172</td>
          <td></td>
          <td>3 (0.0068%)</td>
          <td>
            <div class="callees">
              3 (100.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">		s[:] += .5*model.ϕlsum[a,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-173"></a>173</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-174"></a>174</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.b0[:] = model.η0.+ (scaler.*s)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-175"></a>175</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-176"></a>176</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-177"></a>177</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-178"></a>178</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-179"></a>179</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-180"></a>180</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#updateb0!(model, mb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-181"></a>181</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-updateb1-181"></a>
              1 (0.0023%) samples spent in updateb1!<br />
              0 (ex.),
              1 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-142">line 142</a><br />
            </div>
            <span class="code">function updateb1!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-182"></a>182</td>
          <td></td>
          <td>1 (0.0023%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	model.b1_old = deepcopy(model.b1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-183"></a>183</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	scaler = (model.N^2 - model.N - nnz(model.network))/(2*length(mb.mbnonlinks))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-184"></a>184</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# scaler = (model.N/model.mbsize)*10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-185"></a>185</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-186"></a>186</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		model.b1[k] = model.η1 + (.5*scaler*model.ϕnlinoutsum[k])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-187"></a>187</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-188"></a>188</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-189"></a>189</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-190"></a>190</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-191"></a>191</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-192"></a>192</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_βs!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-193"></a>193</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_β=model.b0./(model.b0.+model.b1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-194"></a>194</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-195"></a>195</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-196"></a>196</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-197"></a>197</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-estimate_-s-197"></a>
              15 (0.03%) samples spent in estimate_θs!<br />
              0 (ex.),
              15 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-131">line 131</a><br />
            </div>
            <span class="code">function estimate_θs!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-198"></a>198</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-199"></a>199</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		# model.est_θ[a,:]=exp(model.μ_var[a,:])./sum(exp(model.μ_var[a,:]))#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-200"></a>200</td>
          <td></td>
          <td>14 (0.03%)</td>
          <td>
            <div class="callees">
              11 (78.57%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-softmax-152">softmax</a><br />
              2 (14.29%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-setindex-968">setindex!</a><br />
              1 (7.14%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">		model.est_θ[a,:]=softmax(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-201"></a>201</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-202"></a>202</td>
          <td></td>
          <td>1 (0.0023%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">	model.est_θ[mb.mbnodes,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-203"></a>203</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-204"></a>204</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-205"></a>205</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-206"></a>206</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_θs!(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-207"></a>207</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in 1:model.N
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-208"></a>208</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		# model.est_θ[a,:]=exp(model.μ_var[a,:])./sum(exp(model.μ_var[a,:]))#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-209"></a>209</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		model.est_θ[a,:]=softmax(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-210"></a>210</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-211"></a>211</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_θ[1:model.N,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-212"></a>212</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-213"></a>213</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-trainutils-jl-update_Elog-213"></a>
              9 (0.02%) samples spent in update_Elogβ!<br />
              0 (ex.),
              9 (100.00%) (incl.)
              when called from
              train
              <a href="train-jl-ca84a6959e82b4de6552-line.html#Ltrain-jl-ca84a6959e82b4de6552-line.html-144">line 144</a><br />
            </div>
            <span class="code">function update_Elogβ!(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-214"></a>214</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-215"></a>215</td>
          <td></td>
          <td>6 (0.01%)</td>
          <td>
            <div class="callees">
              1 (16.67%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-digamma_-95">digamma_</a><br />
              5 (83.33%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-digamma_-95">digamma_</a><br />
            </div>
            <span class="code">		model.Elogβ0[k] = digamma_(model.b0[k]) - (digamma_(model.b0[k])+digamma_(model.b1[k]))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-216"></a>216</td>
          <td></td>
          <td>3 (0.0068%)</td>
          <td>
            <div class="callees">
              3 (100.00%)
              samples spent calling
              <a href="utils-jl-56d1852980543f3415bf-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-modules-utils-jl-digamma_-95">digamma_</a><br />
            </div>
            <span class="code">		model.Elogβ1[k] = digamma_(model.b1[k]) - (digamma_(model.b0[k])+digamma_(model.b1[k]))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-217"></a>217</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-218"></a>218</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-219"></a>219</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-220"></a>220</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_μs(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-221"></a>221</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_μ = reshape(reduce(mean, model.μ_var, 1)&#39;,model.K)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-222"></a>222</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-223"></a>223</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-224"></a>224</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_Λs(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-225"></a>225</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-226"></a>226</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-227"></a>227</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">##How to determine belonging to a community based on the membership vector???
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-228"></a>228</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function computeNMI(x::Matrix{Float64}, y::Matrix{Float64}, communities::Dict{Int64, Vector{Int64}}, threshold::Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-229"></a>229</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file2&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-230"></a>230</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-231"></a>231</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(x,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-232"></a>232</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if x[i,k] &gt; threshold #3.0/size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-233"></a>233</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-234"></a>234</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-235"></a>235</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-236"></a>236</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-237"></a>237</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-238"></a>238</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-239"></a>239</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file1&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-240"></a>240</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-241"></a>241</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(y,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-242"></a>242</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if y[i,k] &gt; threshold #3.0/size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-243"></a>243</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-244"></a>244</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-245"></a>245</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-246"></a>246</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-247"></a>247</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-248"></a>248</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-249"></a>249</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-250"></a>250</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file3&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-251"></a>251</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:length(communities)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-252"></a>252</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  	if length(communities[k]) &lt;= 10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-253"></a>253</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			continue;
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-254"></a>254</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-255"></a>255</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for e in communities[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-256"></a>256</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         	write(f, &quot;$e &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-257"></a>257</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-258"></a>258</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-259"></a>259</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-260"></a>260</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-261"></a>261</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of estimated vs truth&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-262"></a>262</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	run(`src/cpp/NMI/onmi file2 file1`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-263"></a>263</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi = read(`src/cpp/NMI/onmi file2 file1`, String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-264"></a>264</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi=parse(Float64,nmi[6:(end-1)])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-265"></a>265</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of estimated vs init&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-266"></a>266</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	run(`src/cpp/NMI/onmi file2 file3`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-267"></a>267</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of truth vs init&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-268"></a>268</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	run(`src/cpp/NMI/onmi file1 file3`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-269"></a>269</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	return nmi
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-270"></a>270</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-271"></a>271</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function computeNMI_med(x::Matrix{Float64}, y::Matrix{Float64}, communities::Dict{Int64, Vector{Int64}}, threshold::Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-272"></a>272</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file2&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-273"></a>273</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-274"></a>274</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(x,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-275"></a>275</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if x[i,k] &gt; threshold #3.0/size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-276"></a>276</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-277"></a>277</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-278"></a>278</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-279"></a>279</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-280"></a>280</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-281"></a>281</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-282"></a>282</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file1&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-283"></a>283</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-284"></a>284</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(y,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-285"></a>285</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if y[i,k] &gt; threshold #3.0/size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-286"></a>286</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-287"></a>287</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-288"></a>288</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-289"></a>289</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-290"></a>290</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-291"></a>291</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-292"></a>292</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi = read(`src/cpp/NMI/onmi file2 file1`, String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-293"></a>293</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi=parse(Float64,nmi[6:(end-1)])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-294"></a>294</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	return nmi
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-295"></a>295</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-296"></a>296</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-297"></a>297</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function log_comm(model::LNMMSB, mb::MiniBatch, link::Link, link_thresh::Float64, min_deg::Int64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-298"></a>298</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	m_out = indmax(link.ϕout)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-299"></a>299</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	if link.ϕout[m_out] &gt; link_thresh
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-300"></a>300</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.src,m_out]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-301"></a>301</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.dst,m_out]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-302"></a>302</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.src,m_out] &gt; minimum(model.train_outdeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-303"></a>303</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_out], link.src)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-304"></a>304</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-305"></a>305</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-306"></a>306</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.src,m_out] &gt;minimum(model.train_outdeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-307"></a>307</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_out], link.dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-308"></a>308</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-309"></a>309</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-310"></a>310</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	m_in = indmax(link.ϕin)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-311"></a>311</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	if link.ϕin[m_in] &gt; link_thresh
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-312"></a>312</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.src,m_in]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-313"></a>313</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.dst,m_in]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-314"></a>314</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.dst,m_in] &gt; minimum(model.train_indeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-315"></a>315</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_in], link.src)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-316"></a>316</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-317"></a>317</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-318"></a>318</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.dst,m_in] &gt;minimum(model.train_indeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-319"></a>319</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_in], link.dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-320"></a>320</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-321"></a>321</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-322"></a>322</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-323"></a>323</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function compute_NMI3(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-324"></a>324</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-325"></a>325</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./data/est_comm.txt&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-326"></a>326</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:length(model.comm)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-327"></a>327</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for n in model.comm[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-328"></a>328</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$n &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-329"></a>329</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-330"></a>330</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-331"></a>331</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-332"></a>332</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-333"></a>333</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-334"></a>334</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of estimated vs truth&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-335"></a>335</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	# run(`src/cpp/NMI/onmi file2 file1`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-336"></a>336</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi = read(`src/cpp/NMI/onmi data/truth_comm.txt data/est_comm.txt`, String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-337"></a>337</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi=parse(Float64,nmi[6:(end-1)])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-338"></a>338</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	return nmi
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-339"></a>339</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-340"></a>340</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function edge_likelihood(model::LNMMSB,pair::Dyad, β_est::Vector{Float64})
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-341"></a>341</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     s = zero(Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-342"></a>342</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     S = Float64
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-343"></a>343</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     prob = zero(Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-344"></a>344</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	src = pair.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-345"></a>345</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	dst = pair.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-346"></a>346</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	sfxa=softmax(model.μ_var[pair.src,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-347"></a>347</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	sfxb=softmax(model.μ_var[pair.dst,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-348"></a>348</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-349"></a>349</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-350"></a>350</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         if isalink(model, &quot;network&quot;,src, dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-351"></a>351</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#             prob += (sfxa[k]/sum(sfxa))*(sfxb[k]/sum(sfxb))*(β_est[k])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-352"></a>352</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         else
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-353"></a>353</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#             prob += (sfxa[k]/sum(sfxa))*(sfxb[k]/sum(sfxb))*(1.0-β_est[k])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-354"></a>354</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-355"></a>355</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         s += (sfxa[k]/sum(sfxa))*(sfxb[k]/sum(sfxb))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-356"></a>356</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-357"></a>357</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-358"></a>358</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     if isalink(model, &quot;network&quot;,src, dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-359"></a>359</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         prob += (1.0-s)*EPSILON
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-360"></a>360</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     else
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-361"></a>361</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         prob += (1.0-s)*(1.0-EPSILON)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-362"></a>362</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-363"></a>363</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     return log1p(-1.0+prob)::Float64
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-364"></a>364</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-24f2bf461fb71fb4e996-line.html-365"></a>365</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>
      </table>
    </div>
  </body>
</html>
