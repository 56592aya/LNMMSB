<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="statprofiler.css">

    <title>StatProfilerHTML.jl: /home/arashyazdiha/Dropbox/Arash/EUR/Workspace/CLSM/Julia Implementation/ProjectLN/ugraph/src/trainutils.jl</title>
  </head>
  <body>
<div class="report-header">
  <div class="backlink"><a href="index.html">Report index</a></div>
  <div class="report-title">StatProfilerHTML.jl report</div>
  <div class="generated-on">Generated on wo 28 mrt 2018 16:05:06 CEST</div>
</div>

    <div id="body-content">
      <table>
        <caption>File source code</caption>
        <tr>
          <th>Line</td>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-1"></a>1</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># using SpecialFunctions
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-2"></a>2</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">using GradDescent
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-3"></a>3</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">using ForwardDiff
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-4"></a>4</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-5"></a>5</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatephibar!(model::LNMMSB, mb::MiniBatch, a::Int64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-6"></a>6</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	model.ϕbar[a,:]= (model.ϕloutsum[a,:]+model.ϕlinsum[a,:])/(model.train_outdeg[a]+model.train_indeg[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-7"></a>7</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-8"></a>8</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatephil!(model::LNMMSB, mb::MiniBatch, link::Link)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-9"></a>9</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-10"></a>10</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		link.ϕ[k] = model.μ_var[link.src,k] + model.μ_var[link.dst,k]+model.Elogβ0[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-11"></a>11</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-12"></a>12</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	r = logsumexp(link.ϕ)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-13"></a>13</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	link.ϕ[:] = exp.(link.ϕ[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-14"></a>14</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-15"></a>15</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># @btime updatephil!(model, mb, mb.mblinks[1], &quot;hello&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-16"></a>16</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatephil!(model::LNMMSB, mb::MiniBatch, link::Link, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-17"></a>17</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	a = link.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-18"></a>18</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	b = link.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-19"></a>19</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	union_a = union(model.A[a], model.C[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-20"></a>20</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	link.ϕ[:] = model.Elogβ0[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-21"></a>21</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-22"></a>22</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	for k in union_a
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-23"></a>23</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		link.ϕ[k] += model.μ_var[a,k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-24"></a>24</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-25"></a>25</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	union_b = union(model.A[b], model.C[b])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-26"></a>26</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	for k in union_b
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-27"></a>27</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		link.ϕ[k] += model.μ_var[b,k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-28"></a>28</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-29"></a>29</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	if !isempty(model.B[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-30"></a>30</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		κ = model.B[a][1]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-31"></a>31</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		val = model.μ_var[a,κ]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-32"></a>32</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		for k in model.B[a]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-33"></a>33</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			link.ϕ[k] += val
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-34"></a>34</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-35"></a>35</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-36"></a>36</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	if !isempty(model.B[b])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-37"></a>37</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		κ = model.B[b][1]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-38"></a>38</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		val=model.μ_var[b,κ]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-39"></a>39</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		for k in model.B[b]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-40"></a>40</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			link.ϕ[k] += val
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-41"></a>41</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-42"></a>42</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-43"></a>43</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	r = logsumexp(link.ϕ)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-44"></a>44</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	link.ϕ[:] = exp.(link.ϕ[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-45"></a>45</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-46"></a>46</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephil-46"></a>
              1313 (9.12%) samples spent in updatephil!<br />
              138 (100.00%) (ex.),
              1313 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-147">line 147</a><br />
            </div>
            <span class="code">function updatephil!(model::LNMMSB, mb::MiniBatch, link::Link, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-47"></a>47</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	a = link.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-48"></a>48</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	b = link.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-49"></a>49</td>
          <td>7 (0.05%)</td>
          <td>96 (0.67%)</td>
          <td>
            <div class="callees">
              89 (92.71%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_a = vcat(model.A[a], model.C[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-50"></a>50</td>
          <td>10 (0.07%)</td>
          <td>94 (0.65%)</td>
          <td>
            <div class="callees">
              84 (89.36%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_b = vcat(model.A[b], model.C[b])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-51"></a>51</td>
          <td>14 (0.10%)</td>
          <td>14 (0.10%)</td>
          <td>
            <span class="code">	vala = !isempty(model.B[a])? model.μ_var[a, model.B[a][1]]: 0.0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-52"></a>52</td>
          <td>12 (0.08%)</td>
          <td>12 (0.08%)</td>
          <td>
            <span class="code">	valb = !isempty(model.B[b])? model.μ_var[b, model.B[b][1]]: 0.0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-53"></a>53</td>
          <td>2 (0.01%)</td>
          <td>276 (1.92%)</td>
          <td>
            <div class="callees">
              1 (0.36%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-627">setindex!</a><br />
              79 (28.62%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              9 (3.26%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              185 (67.03%)
              samples spent calling
              <a href="operators-jl-e82ac3fc71309b1fcf2d-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-operators-jl-424">+</a><br />
            </div>
            <span class="code">	link.ϕ[:] = model.Elogβ0[:] + vala + valb
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-54"></a>54</td>
          <td>6 (0.04%)</td>
          <td>6 (0.04%)</td>
          <td>
            <span class="code">	for k in union_a
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-55"></a>55</td>
          <td>40 (0.28%)</td>
          <td>40 (0.28%)</td>
          <td>
            <span class="code">		link.ϕ[k] += model.μ_var[a,k] - vala
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-56"></a>56</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-57"></a>57</td>
          <td>2 (0.01%)</td>
          <td>2 (0.01%)</td>
          <td>
            <span class="code">	for k in union_b
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-58"></a>58</td>
          <td>26 (0.18%)</td>
          <td>26 (0.18%)</td>
          <td>
            <span class="code">		link.ϕ[k] += model.μ_var[b,k] - valb
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-59"></a>59</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-60"></a>60</td>
          <td>2 (0.01%)</td>
          <td>263 (1.83%)</td>
          <td>
            <div class="callees">
              1 (0.38%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-logsumexp-107">logsumexp</a><br />
              258 (98.10%)
              samples spent calling
              <a href="utils-jl-86432145f94fb673cc6e-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-utils-jl-logsumexp-107">logsumexp</a><br />
              2 (0.76%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
            </div>
            <span class="code">	r = logsumexp(link.ϕ)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-61"></a>61</td>
          <td>6 (0.04%)</td>
          <td>473 (3.29%)</td>
          <td>
            <div class="callees">
              1 (0.21%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-unsafe_copy-118">unsafe_copy!</a><br />
              1 (0.21%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-626">setindex!</a><br />
              131 (27.70%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              324 (68.50%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              10 (2.11%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
            </div>
            <span class="code">	link.ϕ[:] = exp.(link.ϕ[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-62"></a>62</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-63"></a>63</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatephinl!(model::LNMMSB, mb::MiniBatch, nlink::NonLink)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-64"></a>64</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-65"></a>65</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-66"></a>66</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		nlink.ϕout[k] = model.μ_var[nlink.src,k] + nlink.ϕin[k]*(model.Elogβ1[k]-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-67"></a>67</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		nlink.ϕin[k] = model.μ_var[nlink.dst,k] + nlink.ϕout[k]*(model.Elogβ1[k]-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-68"></a>68</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-69"></a>69</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	r = logsumexp(nlink.ϕout)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-70"></a>70</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nlink.ϕout[:] = exp.(nlink.ϕout[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-71"></a>71</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	r=logsumexp(nlink.ϕin)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-72"></a>72</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nlink.ϕin[:] = exp.(nlink.ϕin[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-73"></a>73</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-74"></a>74</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#I think this requires the two updates to be separated
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-75"></a>75</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinl-75"></a>
              1458 (10.13%) samples spent in updatephinl!<br />
              43 (100.00%) (ex.),
              1458 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-162">line 162</a><br />
            </div>
            <span class="code">function updatephinl!(model::LNMMSB, mb::MiniBatch, nlink::NonLink, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-76"></a>76</td>
          <td>36 (0.25%)</td>
          <td>46 (0.32%)</td>
          <td>
            <div class="callees">
              10 (21.74%)
              samples spent calling
              <a href="random-jl-3c29f269282a0112ca95-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-random-jl-rand-396">rand!</a><br />
            </div>
            <span class="code">	if rand(Bool, 1)[1]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-77"></a>77</td>
          <td>3 (0.02%)</td>
          <td>350 (2.43%)</td>
          <td>
            <div class="callees">
              343 (98.00%)
              samples spent calling
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinlout-87">updatephinlout!</a><br />
              1 (0.29%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-unsafe_copy-118">unsafe_copy!</a><br />
              1 (0.29%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              1 (0.29%)
              samples spent calling
              <a href="mvnormalcanon-jl-f636218910b12a20b6cf-line.html#S-home-arashyazdiha-julia-v0-6-Distributions-src-multivariate-mvnormalcanon-jl-Type-109">Type</a><br />
              1 (0.29%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
            </div>
            <span class="code">		updatephinlout!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-78"></a>78</td>
          <td>2 (0.01%)</td>
          <td>339 (2.36%)</td>
          <td>
            <div class="callees">
              2 (0.59%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              335 (98.82%)
              samples spent calling
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinlin-100">updatephinlin!</a><br />
            </div>
            <span class="code">		updatephinlin!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-79"></a>79</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	else
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-80"></a>80</td>
          <td>1 (0.0069%)</td>
          <td>389 (2.70%)</td>
          <td>
            <div class="callees">
              386 (99.23%)
              samples spent calling
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinlin-100">updatephinlin!</a><br />
              1 (0.26%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              1 (0.26%)
              samples spent calling
              <a href="mvnormalcanon-jl-f636218910b12a20b6cf-line.html#S-home-arashyazdiha-julia-v0-6-Distributions-src-multivariate-mvnormalcanon-jl-Type-109">Type</a><br />
            </div>
            <span class="code">		updatephinlin!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-81"></a>81</td>
          <td>1 (0.0069%)</td>
          <td>334 (2.32%)</td>
          <td>
            <div class="callees">
              3 (0.90%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              330 (98.80%)
              samples spent calling
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinlout-87">updatephinlout!</a><br />
            </div>
            <span class="code">		updatephinlout!(model, mb, nlink, check)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-82"></a>82</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-83"></a>83</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-84"></a>84</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-85"></a>85</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-86"></a>86</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">##
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-87"></a>87</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinlout-87"></a>
              673 (4.68%) samples spent in updatephinlout!<br />
              19 (44.19%) (ex.),
              330 (49.03%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-81">line 81</a><br />
              24 (55.81%) (ex.),
              343 (50.97%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-77">line 77</a><br />
            </div>
            <span class="code">function updatephinlout!(model::LNMMSB, mb::MiniBatch, nlink::NonLink, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-88"></a>88</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	a = nlink.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-89"></a>89</td>
          <td>1 (0.0069%)</td>
          <td>1 (0.0069%)</td>
          <td>
            <span class="code">	b = nlink.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-90"></a>90</td>
          <td>1 (0.0069%)</td>
          <td>74 (0.51%)</td>
          <td>
            <div class="callees">
              47 (63.51%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              26 (35.14%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-log1p-419">log1p</a><br />
            </div>
            <span class="code">	constant = (model.Elogβ1 .-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-91"></a>91</td>
          <td></td>
          <td>80 (0.56%)</td>
          <td>
            <div class="callees">
              3 (3.75%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              77 (96.25%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">	nlink.ϕout[:] = model.μ_var[a,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-92"></a>92</td>
          <td>11 (0.08%)</td>
          <td>71 (0.49%)</td>
          <td>
            <div class="callees">
              60 (84.51%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_b = vcat(model.A[b], model.C[b])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-93"></a>93</td>
          <td>2 (0.01%)</td>
          <td>2 (0.01%)</td>
          <td>
            <span class="code">	for k in union_b
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-94"></a>94</td>
          <td>17 (0.12%)</td>
          <td>17 (0.12%)</td>
          <td>
            <span class="code">		nlink.ϕout[k] += nlink.ϕin[k]*constant[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-95"></a>95</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-96"></a>96</td>
          <td>2 (0.01%)</td>
          <td>136 (0.94%)</td>
          <td>
            <div class="callees">
              3 (2.21%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              131 (96.32%)
              samples spent calling
              <a href="utils-jl-86432145f94fb673cc6e-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-utils-jl-logsumexp-107">logsumexp</a><br />
            </div>
            <span class="code">	r = logsumexp(nlink.ϕout)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-97"></a>97</td>
          <td>2 (0.01%)</td>
          <td>285 (1.98%)</td>
          <td>
            <div class="callees">
              89 (31.23%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              4 (1.40%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              190 (66.67%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
            </div>
            <span class="code">	nlink.ϕout[:] = exp.(nlink.ϕout[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-98"></a>98</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-99"></a>99</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-100"></a>100</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatephinlin-100"></a>
              721 (5.01%) samples spent in updatephinlin!<br />
              21 (44.68%) (ex.),
              335 (46.46%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-78">line 78</a><br />
              26 (55.32%) (ex.),
              386 (53.54%) (incl.)
              when called from
              updatephinl!
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-80">line 80</a><br />
            </div>
            <span class="code">function updatephinlin!(model::LNMMSB, mb::MiniBatch, nlink::NonLink, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-101"></a>101</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	a = nlink.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-102"></a>102</td>
          <td>1 (0.0069%)</td>
          <td>1 (0.0069%)</td>
          <td>
            <span class="code">	b = nlink.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-103"></a>103</td>
          <td></td>
          <td>52 (0.36%)</td>
          <td>
            <div class="callees">
              15 (28.85%)
              samples spent calling
              <a href="math-jl-55feb969e311fdf4e23a-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-math-jl-log1p-419">log1p</a><br />
              37 (71.15%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
            </div>
            <span class="code">	constant = (model.Elogβ1 .-log1p(-EPSILON))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-104"></a>104</td>
          <td></td>
          <td>81 (0.56%)</td>
          <td>
            <div class="callees">
              6 (7.41%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
              75 (92.59%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">	nlink.ϕin[:] = model.μ_var[b,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-105"></a>105</td>
          <td>8 (0.06%)</td>
          <td>75 (0.52%)</td>
          <td>
            <div class="callees">
              67 (89.33%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-vcat-1159">vcat</a><br />
            </div>
            <span class="code">	union_a = vcat(model.A[a], model.C[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-106"></a>106</td>
          <td>4 (0.03%)</td>
          <td>4 (0.03%)</td>
          <td>
            <span class="code">	for k in union_a
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-107"></a>107</td>
          <td>20 (0.14%)</td>
          <td>20 (0.14%)</td>
          <td>
            <span class="code">		nlink.ϕin[k] += nlink.ϕout[k]*constant[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-108"></a>108</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-109"></a>109</td>
          <td>1 (0.0069%)</td>
          <td>150 (1.04%)</td>
          <td>
            <div class="callees">
              148 (98.67%)
              samples spent calling
              <a href="utils-jl-86432145f94fb673cc6e-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-utils-jl-logsumexp-107">logsumexp</a><br />
              1 (0.67%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
            </div>
            <span class="code">	r=logsumexp(nlink.ϕin)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-110"></a>110</td>
          <td>3 (0.02%)</td>
          <td>328 (2.28%)</td>
          <td>
            <div class="callees">
              113 (34.45%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-getindex-568">getindex</a><br />
              201 (61.28%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              11 (3.35%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
            </div>
            <span class="code">	nlink.ϕin[:] = exp.(nlink.ϕin[:] .- r)[:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-111"></a>111</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-112"></a>112</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">##
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-113"></a>113</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-114"></a>114</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function sfx(μ_var::Vector{Float64},ltemp::Vector{Float64})
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-115"></a>115</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	return softmax(μ_var .+.5.*exp.(ltemp))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-116"></a>116</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-117"></a>117</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-sfx-117"></a>
              29 (0.20%) samples spent in sfx<br />
              0 (ex.),
              29 (100.00%) (incl.)
              when called from
              updateμ!
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-139">line 139</a><br />
            </div>
            <span class="code">function sfx(μ_var::Vector{Float64})
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-118"></a>118</td>
          <td></td>
          <td>29 (0.20%)</td>
          <td>
            <div class="callees">
              1 (3.45%)
              samples spent calling
              <a href="exp-jl-b42dee10b321eb245576-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-special-exp-jl-exp-67">exp</a><br />
              28 (96.55%)
              samples spent calling
              <a href="utils-jl-86432145f94fb673cc6e-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-utils-jl-softmax-143">softmax</a><br />
            </div>
            <span class="code">	return softmax(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-119"></a>119</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-120"></a>120</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-121"></a>121</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-122"></a>122</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-123"></a>123</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-124"></a>124</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-update-124"></a>
              6099 (42.37%) samples spent in updateμ!<br />
              227 (100.00%) (ex.),
              6099 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-183">line 183</a><br />
            </div>
            <span class="code">function updateμ!(model::LNMMSB, a::Int64,mb::MiniBatch, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-125"></a>125</td>
          <td></td>
          <td>4 (0.03%)</td>
          <td>
            <div class="callees">
              1 (25.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy-8">deepcopy</a><br />
              1 (25.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              2 (50.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	model.μ_var_old[a,:]=deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-126"></a>126</td>
          <td></td>
          <td>3 (0.02%)</td>
          <td>
            <div class="callees">
              2 (66.67%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              1 (33.33%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	μ_var = deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-127"></a>127</td>
          <td></td>
          <td>4 (0.03%)</td>
          <td>
            <div class="callees">
              4 (100.00%)
              samples spent calling
              <a href="utils-jl-86432145f94fb673cc6e-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-utils-jl-softmax-143">softmax</a><br />
            </div>
            <span class="code">	x = sfx(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-128"></a>128</td>
          <td>2 (0.01%)</td>
          <td>4 (0.03%)</td>
          <td>
            <div class="callees">
              2 (50.00%)
              samples spent calling
              <a href="dict-jl-69dc10398ca233bdae58-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-dict-jl-haskey-505">haskey</a><br />
            </div>
            <span class="code">	s1 = haskey(mb.mbnot,a)?(N-1-model.train_deg[a]):0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-129"></a>129</td>
          <td></td>
          <td>1 (0.0069%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="dict-jl-69dc10398ca233bdae58-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-dict-jl-getindex-474">getindex</a><br />
            </div>
            <span class="code">	c1 = haskey(mb.mbnot,a)?length(mb.mbnot[a]):1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-130"></a>130</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-131"></a>131</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	sumb =(model.N-1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-132"></a>132</td>
          <td>184 (1.28%)</td>
          <td>330 (2.29%)</td>
          <td>
            <div class="callees">
              8 (2.42%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              4 (1.21%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              126 (38.18%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast_c-311">broadcast_c</a><br />
              8 (2.42%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">	X=model.ϕlsum[a,:]+(s1/c1).*.5.*(model.ϕnloutsum[a,:]+model.ϕnlinsum[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-133"></a>133</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	##added this line
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-134"></a>134</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-dfunci-134"></a>
              2458 (17.08%) samples spent in dfunci<br />
              64 (100.00%) (ex.),
              2458 (100.00%) (incl.)
              when called from
              updateμ!
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-140">line 140</a><br />
            </div>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-135"></a>135</td>
          <td>68 (0.47%)</td>
          <td>2462 (17.10%)</td>
          <td>
            <div class="callees">
              18 (0.73%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-gemv-252">gemv!</a><br />
              20 (0.81%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">-</a><br />
              3 (0.12%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-75">*</a><br />
              2322 (94.31%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-454">broadcast</a><br />
              25 (1.02%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              6 (0.24%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
            </div>
            <span class="code">	dfunci(μ_var) = -model.l.*model.L*(μ_var-model.m) +X - sumb.*x
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-136"></a>136</td>
          <td>1 (0.0069%)</td>
          <td>1 (0.0069%)</td>
          <td>
            <span class="code">	opt1 = Adagrad()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-137"></a>137</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-138"></a>138</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for i in 1:10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-139"></a>139</td>
          <td>8 (0.06%)</td>
          <td>37 (0.26%)</td>
          <td>
            <div class="callees">
              29 (78.38%)
              samples spent calling
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-sfx-117">sfx</a><br />
            </div>
            <span class="code">		x  = sfx(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-140"></a>140</td>
          <td>8 (0.06%)</td>
          <td>2466 (17.13%)</td>
          <td>
            <div class="callees">
              2458 (99.68%)
              samples spent calling
              <a href="trainutils-jl-7dc5bc0556623aa4c0ca-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-dfunci-134">dfunci</a><br />
            </div>
            <span class="code">		g1 = dfunci(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-141"></a>141</td>
          <td>11 (0.08%)</td>
          <td>3231 (22.45%)</td>
          <td>
            <div class="callees">
              3220 (99.66%)
              samples spent calling
              <a href="AdaGradOptimizer-jl-7c6670f2b61e6bc30b2d-line.html#S-home-arashyazdiha-julia-v0-6-GradDescent-src-AdaGradOptimizer-jl-update-20">update</a><br />
            </div>
            <span class="code">		δ1 = update(opt1,g1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-142"></a>142</td>
          <td>4 (0.03%)</td>
          <td>7 (0.05%)</td>
          <td>
            <div class="callees">
              3 (42.86%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
            </div>
            <span class="code">		μ_var+=δ1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-143"></a>143</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-144"></a>144</td>
          <td>2 (0.01%)</td>
          <td>3 (0.02%)</td>
          <td>
            <div class="callees">
              1 (33.33%)
              samples spent calling
              <a href="multidimensional-jl-b15f86aca7aa36da9d41-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-multidimensional-jl-_setindex-536">_setindex!</a><br />
            </div>
            <span class="code">	model.μ_var[a,:]=μ_var
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-145"></a>145</td>
          <td>3 (0.02%)</td>
          <td>4 (0.03%)</td>
          <td>
            <div class="callees">
              1 (25.00%)
              samples spent calling
              <a href="io-jl-7f272ef1fa6cfc3f4fd8-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-strings-io-jl-print-36">print</a><br />
            </div>
            <span class="code">	print();
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-146"></a>146</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-147"></a>147</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-148"></a>148</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-149"></a>149</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatesimulμΛ!(model::LNMMSB, a::Int64,mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-150"></a>150</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.μ_var_old[a,:]=deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-151"></a>151</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		#model.Λ_var_old[a,:]=deepcopy(model.Λ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-152"></a>152</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		μ_var = deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-153"></a>153</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		#Λ_ivar = deepcopy(1.0./model.Λ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-154"></a>154</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		#ltemp = [log(Λ_ivar[k]) for k in 1:model.K]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-155"></a>155</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		#x = sfx(μ_var,ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-156"></a>156</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		x = sfx(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-157"></a>157</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		s1 = haskey(mb.mbnot,a)?(N-1-model.train_deg[a]):0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-158"></a>158</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		c1 = haskey(mb.mbnot,a)?length(mb.mbnot[a]):1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-159"></a>159</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-160"></a>160</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		sumb =(model.N-1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-161"></a>161</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		X=model.ϕlsum[a,:]+(s1/c1).*.5.*(model.ϕnloutsum[a,:]+model.ϕnlinsum[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-162"></a>162</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		##added this line
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-163"></a>163</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-164"></a>164</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		#model.μ_var[a,:] = model.m + inv(model.l*model.L)* (X - (model.N-1)*model.est_θ[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-165"></a>165</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		dfunci(μ_var) = -model.l.*model.L*(μ_var-model.m) +X - sumb.*x
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-166"></a>166</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         #
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-167"></a>167</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# func1i(μ_var) = -.5*model.l*((μ_var-model.m)&#39;*model.L*(μ_var-model.m))+
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-168"></a>168</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# (X)&#39;*μ_var-	sumb*(log(ones(model.K)&#39;*exp.(μ_var+.5.*exp.(ltemp))))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-169"></a>169</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         #
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-170"></a>170</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# func2i(ltemp) =-.5*model.l*(diag(model.L)&#39;*exp.(ltemp))+.5*ones(Float64, model.K)&#39;*ltemp-sumb*(log(ones(model.K)&#39;*exp.(model.μ_var[a,:]+.5.*exp.(ltemp))))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-171"></a>171</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         #
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-172"></a>172</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# # opt1 = RMSprop()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-173"></a>173</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# # opt2 = RMSprop()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-174"></a>174</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		opt1 = Adagrad()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-175"></a>175</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# opt2 = Adagrad()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-176"></a>176</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         #
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-177"></a>177</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-178"></a>178</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		for i in 1:10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-179"></a>179</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			# x  = sfx(μ_var,ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-180"></a>180</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			x  = sfx(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-181"></a>181</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			g1 = dfunci(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-182"></a>182</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			δ1 = update(opt1,g1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-183"></a>183</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			# g2 = ForwardDiff.gradient(func2i, ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-184"></a>184</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			# δ2 = update(opt2,g2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-185"></a>185</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			μ_var+=δ1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-186"></a>186</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			# ltemp+=δ2
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-187"></a>187</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-188"></a>188</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.μ_var[a,:]=μ_var
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-189"></a>189</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# model.Λ_var[a,:]=1.0./exp.(ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-190"></a>190</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	# end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-191"></a>191</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	print();
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-192"></a>192</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-193"></a>193</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function updatesimulμΛ!(model::LNMMSB, a::Int64,mb::MiniBatch, check::String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-194"></a>194</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		activecandidateidx = union(model.Active[a], model.Candidate[a])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-195"></a>195</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		rest = setdiff(1:model.K,activecandidateidx)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-196"></a>196</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.μ_var_old[a,activecandidateidx]=deepcopy(model.μ_var[a,activecandidateidx])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-197"></a>197</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.Λ_var_old[a,activecandidateidx]=deepcopy(model.Λ_var[a,activecandidateidx])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-198"></a>198</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.μ_var_old[a,rest].=deepcopy(model.μ_var[a,rest[1]])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-199"></a>199</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.Λ_var_old[a,rest].=deepcopy(model.Λ_var[a,rest[1]])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-200"></a>200</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		μ_var = deepcopy(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-201"></a>201</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		Λ_ivar = deepcopy(1.0./model.Λ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-202"></a>202</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		ltemp = [log(Λ_ivar[k]) for k in 1:model.K]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-203"></a>203</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		x = sfx(μ_var,ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-204"></a>204</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		s1 = haskey(mb.mbnot,a)?(N-1-model.train_deg[a]):0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-205"></a>205</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		c1 = haskey(mb.mbnot,a)?length(mb.mbnot[a]):1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-206"></a>206</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-207"></a>207</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		sumb =(model.N-1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-208"></a>208</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		X=model.ϕlsum[a,:]+(s1/c1).*.5.*(model.ϕnloutsum[a,:]+model.ϕnlinsum[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-209"></a>209</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-210"></a>210</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		dfunci(μ_var) = -model.l.*model.L*(μ_var-model.m) +X - sumb.*x
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-211"></a>211</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-212"></a>212</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		func1i(μ_var) = -.5*model.l*((μ_var-model.m)&#39;*model.L*(μ_var-model.m))+
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-213"></a>213</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		(X)&#39;*μ_var-	sumb*(log(ones(model.K)&#39;*exp.(μ_var+.5.*exp.(ltemp))))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-214"></a>214</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-215"></a>215</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		func2i(ltemp) =-.5*model.l*(diag(model.L)&#39;*exp.(ltemp))+.5*ones(Float64, model.K)&#39;*ltemp-sumb*(log(ones(model.K)&#39;*exp.(model.μ_var[a,:]+.5.*exp.(ltemp))))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-216"></a>216</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-217"></a>217</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# opt1 = RMSprop()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-218"></a>218</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		# opt2 = RMSprop()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-219"></a>219</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		opt1 = Adagrad()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-220"></a>220</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		opt2 = Adagrad()
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-221"></a>221</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-222"></a>222</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		for i in 1:10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-223"></a>223</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			x  = sfx(μ_var,ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-224"></a>224</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			g1 = dfunci(μ_var)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-225"></a>225</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			δ1 = update(opt1,g1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-226"></a>226</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			g2 = ForwardDiff.gradient(func2i, ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-227"></a>227</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			δ2 = update(opt2,g2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-228"></a>228</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			μ_var+=δ1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-229"></a>229</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			ltemp+=δ2
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-230"></a>230</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-231"></a>231</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.μ_var[a,:]=μ_var
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-232"></a>232</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.Λ_var[a,:]=1.0./exp.(ltemp)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-233"></a>233</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	# end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-234"></a>234</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	print();
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-235"></a>235</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-236"></a>236</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-237"></a>237</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updateM-237"></a>
              1 (0.0069%) samples spent in updateM!<br />
              0 (ex.),
              1 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-203">line 203</a><br />
            </div>
            <span class="code">function updateM!(model::LNMMSB,mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-238"></a>238</td>
          <td></td>
          <td>1 (0.0069%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	model.M_old = deepcopy(model.M)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-239"></a>239</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.M = ((model.l*model.N).*model.L)+model.M0
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-240"></a>240</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-241"></a>241</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#updateM!(model,mb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-242"></a>242</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updatem-242"></a>
              16 (0.11%) samples spent in updatem!<br />
              0 (ex.),
              16 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-200">line 200</a><br />
            </div>
            <span class="code">function updatem!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-243"></a>243</td>
          <td></td>
          <td>1 (0.0069%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="deepcopy-jl-f860bf8b8536f6dbac26-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-deepcopy-jl-deepcopy_internal-54">deepcopy_internal</a><br />
            </div>
            <span class="code">	model.m_old = deepcopy(model.m)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-244"></a>244</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s = zeros(Float64, model.K)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-245"></a>245</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-246"></a>246</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		s.+=model.μ_var[a,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-247"></a>247</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-248"></a>248</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-249"></a>249</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	scaler = model.N/model.mbsize
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-250"></a>250</td>
          <td></td>
          <td>15 (0.10%)</td>
          <td>
            <div class="callees">
              1 (6.67%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              1 (6.67%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-75">*</a><br />
              2 (13.33%)
              samples spent calling
              <a href="matmul-jl-f7b90faca49c816dec68-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-matmul-jl-gemv-252">gemv!</a><br />
              11 (73.33%)
              samples spent calling
              <a href="dense-jl-9a4e14799b411a7dd560-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-dense-jl-inv-650">inv</a><br />
            </div>
            <span class="code">	model.m=inv(model.M)*(model.M0*model.m0+(scaler*model.l).*model.L*s)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-251"></a>251</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-252"></a>252</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function updatel!(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-253"></a>253</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	##should be set in advance, not needed in the loop
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-254"></a>254</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.l = model.l0+convert(Float64,model.N)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-255"></a>255</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-256"></a>256</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#updatel!(model,mb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-257"></a>257</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updateL-257"></a>
              215 (1.49%) samples spent in updateL!<br />
              2 (100.00%) (ex.),
              215 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-206">line 206</a><br />
            </div>
            <span class="code">function updateL!(model::LNMMSB, mb::MiniBatch, i::Int64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-258"></a>258</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.L_old = deepcopy(model.L)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-259"></a>259</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s = zero(Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-260"></a>260</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-261"></a>261</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# 	s +=(model.μ_var[a,:]-model.m)*(model.μ_var[a,:]-model.m)&#39;+diagm(1.0./model.Λ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-262"></a>262</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-263"></a>263</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	#added this for instead
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-264"></a>264</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-265"></a>265</td>
          <td></td>
          <td>7 (0.05%)</td>
          <td>
            <div class="callees">
              1 (14.29%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-44">+</a><br />
              3 (42.86%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              1 (14.29%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">-</a><br />
              2 (28.57%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
            </div>
            <span class="code">		s +=(model.μ_var[a,:]-model.m)*(model.μ_var[a,:]-model.m)&#39;
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-266"></a>266</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-267"></a>267</td>
          <td></td>
          <td>1 (0.0069%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-44">*</a><br />
            </div>
            <span class="code">	s=(model.N/model.mbsize)*s
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-268"></a>268</td>
          <td></td>
          <td>199 (1.38%)</td>
          <td>
            <div class="callees">
              2 (1.01%)
              samples spent calling
              <a href="arraymath-jl-b564666165cf37ea0005-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-arraymath-jl-37">+</a><br />
              4 (2.01%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
              193 (96.98%)
              samples spent calling
              <a href="dense-jl-9a4e14799b411a7dd560-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-dense-jl-inv-650">inv</a><br />
            </div>
            <span class="code">	s+=inv(model.L0)+model.N.*inv(model.M)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-269"></a>269</td>
          <td>1 (0.0069%)</td>
          <td>1 (0.0069%)</td>
          <td>
            <span class="code">	model.L = try
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-270"></a>270</td>
          <td></td>
          <td>6 (0.04%)</td>
          <td>
            <div class="callees">
              6 (100.00%)
              samples spent calling
              <a href="dense-jl-9a4e14799b411a7dd560-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-linalg-dense-jl-inv-650">inv</a><br />
            </div>
            <span class="code">		inv(s)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-271"></a>271</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	catch y
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-272"></a>272</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		if isa(y, Base.LinAlg.SingularException)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-273"></a>273</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">			println(&quot;i is &quot;, i)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-274"></a>274</td>
          <td>1 (0.0069%)</td>
          <td>1 (0.0069%)</td>
          <td>
            <span class="code">			error(&quot;hey hey hey singular&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-275"></a>275</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-276"></a>276</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-277"></a>277</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-278"></a>278</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-279"></a>279</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-280"></a>280</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-281"></a>281</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-updateb0-281"></a>
              3 (0.02%) samples spent in updateb0!<br />
              0 (ex.),
              3 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-209">line 209</a><br />
            </div>
            <span class="code">function updateb0!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-282"></a>282</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.b0_old = deepcopy(model.b0)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-283"></a>283</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	scaler=nnz(model.network)/(2*length(mb.mblinks))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-284"></a>284</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# @assert !isequal(model.ϕlinoutsum[:], zeros(Float64, model.K))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-285"></a>285</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	s = zeros(Float64, model.K)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-286"></a>286</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in model.mbids
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-287"></a>287</td>
          <td></td>
          <td>2 (0.01%)</td>
          <td>
            <div class="callees">
              1 (50.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
              1 (50.00%)
              samples spent calling
              <a href="array-jl-c31e5f0854745d9d2638-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-array-jl-setindex-629">setindex!</a><br />
            </div>
            <span class="code">		s[:] += .5*model.ϕlsum[a,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-288"></a>288</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-289"></a>289</td>
          <td></td>
          <td>1 (0.0069%)</td>
          <td>
            <div class="callees">
              1 (100.00%)
              samples spent calling
              <a href="broadcast-jl-ef111e8220ee56a27253-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-broadcast-jl-broadcast-455">broadcast</a><br />
            </div>
            <span class="code">	model.b0[:] = model.η0.+ (scaler.*s)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-290"></a>290</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-291"></a>291</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-292"></a>292</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-293"></a>293</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-294"></a>294</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-295"></a>295</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#updateb0!(model, mb)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-296"></a>296</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function updateb1!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-297"></a>297</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.b1_old = deepcopy(model.b1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-298"></a>298</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	scaler = (model.N^2 - model.N - nnz(model.network))/(2*length(mb.mbnonlinks))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-299"></a>299</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	# scaler = (model.N/model.mbsize)*10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-300"></a>300</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-301"></a>301</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		model.b1[k] = model.η1 + (.5*scaler*model.ϕnlinoutsum[k])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-302"></a>302</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-303"></a>303</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-304"></a>304</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-305"></a>305</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-306"></a>306</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-307"></a>307</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_βs!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-308"></a>308</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_β=model.b0./(model.b0.+model.b1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-309"></a>309</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-310"></a>310</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-311"></a>311</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-312"></a>312</td>
          <td></td>
          <td></td>
          <td>
            <div class="call-sites">
              <a name="S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-trainutils-jl-estimate_-s-312"></a>
              4 (0.03%) samples spent in estimate_θs!<br />
              0 (ex.),
              4 (100.00%) (incl.)
              when called from
              macro expansion
              <a href="train-jl-94893ea3787006a1b46c-line.html#Ltrain-jl-94893ea3787006a1b46c-line.html-193">line 193</a><br />
            </div>
            <span class="code">function estimate_θs!(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-313"></a>313</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in mb.mbnodes
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-314"></a>314</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		# model.est_θ[a,:]=exp(model.μ_var[a,:])./sum(exp(model.μ_var[a,:]))#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-315"></a>315</td>
          <td></td>
          <td>4 (0.03%)</td>
          <td>
            <div class="callees">
              3 (75.00%)
              samples spent calling
              <a href="utils-jl-86432145f94fb673cc6e-line.html#S-home-arashyazdiha-Dropbox-Arash-EUR-Workspace-CLSM-Julia-Implementation-ProjectLN-ugraph-src-utils-jl-softmax-143">softmax</a><br />
              1 (25.00%)
              samples spent calling
              <a href="abstractarray-jl-06d2cc8b8cb2c00f4baa-line.html#S-home-arashyazdiha-Documents-Programs-julia-d386e40c17-bin-share-julia-base-abstractarray-jl-getindex-883">getindex</a><br />
            </div>
            <span class="code">		model.est_θ[a,:]=softmax(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-316"></a>316</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-317"></a>317</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_θ[mb.mbnodes,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-318"></a>318</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-319"></a>319</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-320"></a>320</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-321"></a>321</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_θs!(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-322"></a>322</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	for a in 1:model.N
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-323"></a>323</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		# model.est_θ[a,:]=exp(model.μ_var[a,:])./sum(exp(model.μ_var[a,:]))#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-324"></a>324</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">		model.est_θ[a,:]=softmax(model.μ_var[a,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-325"></a>325</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-326"></a>326</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_θ[1:model.N,:]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-327"></a>327</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-328"></a>328</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-329"></a>329</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_μs(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-330"></a>330</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">	model.est_μ = reshape(reduce(mean, model.μ_var, 1)&#39;,model.K)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-331"></a>331</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-332"></a>332</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-333"></a>333</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">function estimate_Λs(model::LNMMSB, mb::MiniBatch)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-334"></a>334</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-335"></a>335</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-336"></a>336</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">##How to determine belonging to a community based on the membership vector???
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-337"></a>337</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function computeNMI(x::Matrix{Float64}, y::Matrix{Float64}, communities::Dict{Int64, Vector{Int64}}, threshold::Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-338"></a>338</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file2&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-339"></a>339</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-340"></a>340</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(x,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-341"></a>341</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if x[i,k] &gt; threshold #3.0/size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-342"></a>342</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-343"></a>343</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-344"></a>344</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-345"></a>345</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-346"></a>346</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-347"></a>347</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-348"></a>348</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file1&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-349"></a>349</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-350"></a>350</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(y,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-351"></a>351</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if y[i,k] &gt; threshold #3.0/size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-352"></a>352</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-353"></a>353</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-354"></a>354</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-355"></a>355</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-356"></a>356</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-357"></a>357</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-358"></a>358</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-359"></a>359</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file3&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-360"></a>360</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:length(communities)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-361"></a>361</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  	if length(communities[k]) &lt;= 10
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-362"></a>362</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			continue;
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-363"></a>363</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-364"></a>364</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for e in communities[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-365"></a>365</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         	write(f, &quot;$e &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-366"></a>366</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-367"></a>367</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-368"></a>368</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-369"></a>369</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-370"></a>370</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of estimated vs truth&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-371"></a>371</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	run(`src/cpp/NMI/onmi file2 file1`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-372"></a>372</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi = read(`src/cpp/NMI/onmi file2 file1`, String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-373"></a>373</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi=parse(Float64,nmi[6:(end-1)])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-374"></a>374</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of estimated vs init&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-375"></a>375</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	run(`src/cpp/NMI/onmi file2 file3`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-376"></a>376</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of truth vs init&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-377"></a>377</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	run(`src/cpp/NMI/onmi file1 file3`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-378"></a>378</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	return nmi
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-379"></a>379</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-380"></a>380</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function computeNMI_med(x::Matrix{Float64}, y::Matrix{Float64}, communities::Dict{Int64, Vector{Int64}}, threshold::Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-381"></a>381</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file2&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-382"></a>382</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-383"></a>383</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(x,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-384"></a>384</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if x[i,k] &gt; threshold #3.0/size(x,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-385"></a>385</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-386"></a>386</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-387"></a>387</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-388"></a>388</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-389"></a>389</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-390"></a>390</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-391"></a>391</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./file1&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-392"></a>392</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-393"></a>393</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for i in 1:size(y,1)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-394"></a>394</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      if y[i,k] &gt; threshold #3.0/size(y,2)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-395"></a>395</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$i &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-396"></a>396</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	      end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-397"></a>397</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-398"></a>398</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-399"></a>399</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-400"></a>400</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-401"></a>401</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi = read(`src/cpp/NMI/onmi file2 file1`, String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-402"></a>402</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi=parse(Float64,nmi[6:(end-1)])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-403"></a>403</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	return nmi
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-404"></a>404</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-405"></a>405</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-406"></a>406</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function log_comm(model::LNMMSB, mb::MiniBatch, link::Link, link_thresh::Float64, min_deg::Int64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-407"></a>407</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	m_out = indmax(link.ϕout)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-408"></a>408</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	if link.ϕout[m_out] &gt; link_thresh
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-409"></a>409</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.src,m_out]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-410"></a>410</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.dst,m_out]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-411"></a>411</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.src,m_out] &gt; minimum(model.train_outdeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-412"></a>412</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_out], link.src)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-413"></a>413</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-414"></a>414</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-415"></a>415</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.src,m_out] &gt;minimum(model.train_outdeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-416"></a>416</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_out], link.dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-417"></a>417</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-418"></a>418</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-419"></a>419</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	m_in = indmax(link.ϕin)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-420"></a>420</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	if link.ϕin[m_in] &gt; link_thresh
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-421"></a>421</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.src,m_in]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-422"></a>422</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		model.fmap[link.dst,m_in]+=1
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-423"></a>423</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.dst,m_in] &gt; minimum(model.train_indeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-424"></a>424</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_in], link.src)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-425"></a>425</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-426"></a>426</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-427"></a>427</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		if model.fmap[link.dst,m_in] &gt;minimum(model.train_indeg)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-428"></a>428</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 			push!(model.comm[m_in], link.dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-429"></a>429</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 		end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-430"></a>430</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-431"></a>431</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-432"></a>432</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function compute_NMI3(model::LNMMSB)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-433"></a>433</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-434"></a>434</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	open(&quot;./data/est_comm.txt&quot;, &quot;w&quot;) do f
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-435"></a>435</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  for k in 1:length(model.comm)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-436"></a>436</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    for n in model.comm[k]
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-437"></a>437</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	        write(f, &quot;$n &quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-438"></a>438</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-439"></a>439</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	    write(f, &quot;\n&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-440"></a>440</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	  end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-441"></a>441</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-442"></a>442</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-443"></a>443</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	println(&quot;NMI of estimated vs truth&quot;)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-444"></a>444</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	# run(`src/cpp/NMI/onmi file2 file1`)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-445"></a>445</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi = read(`src/cpp/NMI/onmi data/truth_comm.txt data/est_comm.txt`, String)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-446"></a>446</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	nmi=parse(Float64,nmi[6:(end-1)])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-447"></a>447</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	return nmi
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-448"></a>448</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-449"></a>449</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># function edge_likelihood(model::LNMMSB,pair::Dyad, β_est::Vector{Float64})
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-450"></a>450</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     s = zero(Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-451"></a>451</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     S = Float64
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-452"></a>452</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     prob = zero(Float64)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-453"></a>453</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	src = pair.src
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-454"></a>454</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	dst = pair.dst
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-455"></a>455</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	sfxa=softmax(model.μ_var[pair.src,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-456"></a>456</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># 	sfxb=softmax(model.μ_var[pair.dst,:])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-457"></a>457</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     for k in 1:model.K
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-458"></a>458</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-459"></a>459</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         if isalink(model, &quot;network&quot;,src, dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-460"></a>460</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#             prob += (sfxa[k]/sum(sfxa))*(sfxb[k]/sum(sfxb))*(β_est[k])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-461"></a>461</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         else
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-462"></a>462</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#             prob += (sfxa[k]/sum(sfxa))*(sfxb[k]/sum(sfxb))*(1.0-β_est[k])
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-463"></a>463</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-464"></a>464</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         s += (sfxa[k]/sum(sfxa))*(sfxb[k]/sum(sfxb))
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-465"></a>465</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-466"></a>466</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-467"></a>467</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     if isalink(model, &quot;network&quot;,src, dst)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-468"></a>468</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         prob += (1.0-s)*EPSILON
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-469"></a>469</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     else
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-470"></a>470</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#         prob += (1.0-s)*(1.0-EPSILON)
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-471"></a>471</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-472"></a>472</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">#     return log1p(-1.0+prob)::Float64
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-473"></a>473</td>
          <td></td>
          <td></td>
          <td>
            <span class="code"># end
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-474"></a>474</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-475"></a>475</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">
</span>
          </td>
        </tr>

        <tr>
          <td><a name="Ltrainutils-jl-7dc5bc0556623aa4c0ca-line.html-476"></a>476</td>
          <td></td>
          <td></td>
          <td>
            <span class="code">print(&quot;&quot;);
</span>
          </td>
        </tr>
      </table>
    </div>
  </body>
</html>
